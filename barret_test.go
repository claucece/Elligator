package ed448

import . "gopkg.in/check.v1"

func (s *Ed448Suite) TestBarretDeserializeAndReduce(c *C) {
	serialized := [64]byte{
		0x1d, 0x07, 0xfb, 0x9c, 0x79, 0x80, 0x5f, 0x01,
		0x52, 0xc9, 0x09, 0xbf, 0x4c, 0xdb, 0xb1, 0x31,
		0x95, 0x31, 0x78, 0xc9, 0xff, 0x4f, 0x34, 0xc7,
		0x77, 0x7c, 0x89, 0x4e, 0xe0, 0x8f, 0xca, 0x9f,
		0x59, 0x8a, 0x00, 0x37, 0x78, 0x2c, 0xa6, 0x9b,
		0xbe, 0x5b, 0xb4, 0x1d, 0x25, 0x6a, 0x83, 0x32,
		0x7c, 0xd0, 0xc0, 0x3d, 0xa5, 0x26, 0xf8, 0x77,
		0xd3, 0x74, 0x3e, 0x3b, 0x7b, 0x21, 0x70, 0x01,
	}

	result := [fieldWords]word_t{}

	barretDeserializeAndReduce(result[:], serialized, &curvePrimeOrder)

	c.Assert(result, DeepEquals, [fieldWords]word_t{
		0x3e3f0106, 0x109e3fb3,
		0x2334dede, 0x44759a6a,
		0x4f184169, 0x5052b779,
		0xe27da003, 0x8a15ee89,
		0x39f344af, 0x9ba62c78,
		0x1db45bbe, 0x32836a25,
		0x3dc0d07c, 0x37f826a5,
	})
}
